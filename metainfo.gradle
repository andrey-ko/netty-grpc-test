task generateMetaInfo(type: TransformTask) {
  group 'codegen'
  description "generate meta information class"
  generateCode.dependsOn(it)

  def outputDir = file("meta-info")
  def className = "MetaInfo"
  def classFile = file("$outputDir/$pckgDir/${className}.kt")

  template = rootProject.file('metainfo.template.kt')
  output = classFile
  model.className = className

  inputs.property("gitSha", rootProject.gitSha)
  inputs.file(rootProject.file("gradle.properties"))
  inputs.file(template)
  outputs.file(output)

  project.sourceSets.main.kotlin.srcDirs += outputDir

  doFirst {
    outputDir.mkdirs()
    model.sha = rootProject.gitSha
    model.tags = rootProject.gitTags
  }

  clean.doFirst {
    delete(outputDir)
  }
}
